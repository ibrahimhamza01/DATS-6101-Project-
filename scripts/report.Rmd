---
title: "DATS 6101 Project 1"
author: "Syed Ibrahim Hamza, Pratik Shetty, and Dominique Howell"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
    number_sections: true
    theme: united
    code_folding: hide
---


```{css, echo=FALSE}
/* Font adjustments */
body { font-size: 14px; line-height: 1.5; }
h1 { font-size: 26px; }
h2 { font-size: 20px; }
h3 { font-size: 18px; }
.tocify-content { font-size: 14px !important; }
```

```{r setup, message=FALSE, warning=FALSE, echo=FALSE}
library(dplyr)
library(ggplot2)
library(scales)
library(gridExtra)
library(ezids)
library(survey)
library(kableExtra)
library(stats)
library(readr)
library(tidyr)
library(car)

brfss = readRDS("../data/processed/brfss_2018_2023.rds")
```

# Introduction

## Project Overview
This project examines the **impact of COVID-19 on obesity and lifestyle behaviors** among U.S. adults using the **CDC Behavioral Risk Factor Surveillance System (BRFSS)** data from **2018–2023**.  
The BRFSS is a nationally representative health survey that collects information on demographics, chronic health conditions, and behavioral risk factors from approximately **400,000 adults annually** across all 50 states, Washington D.C., and U.S. territories.  
Our primary goal is to evaluate how obesity prevalence and lifestyle behaviors such as physical activity and alcohol use have changed before and after the onset of COVID-19, and how these trends vary by demographic and health factors.


## Data Sources
- **Raw data**: stored in `data/raw/`, obtained from the [CDC BRFSS Annual Data Portal](https://www.cdc.gov/brfss/annual_data/annual_data.htm).  
- **Processed data**: cleaned and merged dataset saved in `data/processed/`.  
- **Final analytical dataset**: `data/processed/brfss_2018_2023.rds` (over 100k observations, ~24 variables).  

Here is a glimpse of how the data appeared previously.
```{r, message=FALSE, warning=FALSE}
before <- read.csv("../data/raw/brfss_2018_sample.csv", stringsAsFactors = FALSE)
kable(before[1:5, 1:9])
```

# Data Preparation

## Overview
Here is a glimpse of processed data.
```{r, message=FALSE, warning=FALSE}
after <- read.csv("../data/processed/brfss_2018_clean_sample.csv", stringsAsFactors = FALSE)
kable(after[1:5, 1:9])
```
<br>
<br>
The data preparation process involved two main stages implemented in custom R scripts:

## From `data_cleaning.R`
- Performs initial filtering, variable selection, and calculation of derived variables (e.g., BMI).  
- Imported annual BRFSS files (2018–2023) and selected relevant variables for BMI, physical activity, alcohol use, and chronic conditions.  
- Computed **BMI** using self-reported height and weight and categorized individuals into *Underweight, Normal weight, Overweight,* and *Obese*.  
- Created binary indicators:
  - `overweight_or_obese` (BMI ≥ 25)
  - `any_exercise_last_month` and `exercise_30day` (physical activity engagement)
  - `binge_drinking` (based on reported alcohol consumption)  
- Filtered out records with implausible BMI values and missing key demographics.  
- Appended all years into a single longitudinal dataset (`brfss_2018_2023.csv`).  

## From `apply_factors.R`
- Converts categorical variables to descriptive factor labels and ensures consistent metadata for survey analysis.
- Implemented a **`safe_factor()`** helper function to standardize categorical variables that may be stored as numeric codes or text.  
- Applied consistent factor mappings for:
  - **Demographics:** sex, age group, race/ethnicity, education, income, and state (using FIPS codes).  
  - **Lifestyle behaviors:** physical activity and alcohol use indicators.  
  - **Health outcomes:** diabetes, heart disease, stroke, depression, and self-reported health status.  
- Preserved factor orderings for ordinal variables (e.g., income, education).  
- Saved the final dataset as an RDS file with factor attributes intact (`brfss_2018_2023.rds`).

# Summary Statistics
```{r, message=FALSE, warning=FALSE}
# Descriptive tables (overall & by year)
desc_overall <- data.frame(
  n = nrow(brfss),
  mean_bmi = mean(brfss$bmi, na.rm = TRUE),
  sd_bmi = sd(brfss$bmi, na.rm = TRUE),
  obesity_n = sum(brfss$overweight_or_obese == "Yes"),
  obesity_pct = mean(brfss$overweight_or_obese == "Yes")
)
knitr::kable(desc_overall, caption = '<span style="font-weight: bold;color: blue;">Overall Descriptive Statistics</span>')
```
<br>
Across 2018–2023, **134,283 adults** were analyzed with an average **BMI of 28.17 (SD = 5.90)**, indicating an **overweight** population. Overall, **68.8%** were **overweight or obese**, emphasizing the need to explore lifestyle factors like **physical activity** and **binge drinking** in relation to obesity risk.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
desc_by_year <- brfss %>%
  group_by(interview_year) %>%
  summarise(
    n = n(),
    mean_bmi = mean(bmi, na.rm=TRUE),
    sd_bmi = sd(bmi, na.rm=TRUE),
    obesity_n = sum(overweight_or_obese == "Yes"),
    obesity_pct = mean(overweight_or_obese == "Yes"),
    exercise_pct = mean(any_exercise_last_month == "Yes"),
    binge_pct = mean(binge_drinking == "Yes"),
    .groups = "drop"
  )
knitr::kable(desc_by_year, caption = '<span style="font-weight: bold;color: hotpink;">Descriptive Statistics by Year</span>')
```
<br>
From **2018 to 2023**, mean BMI and obesity prevalence showed a slight upward trend, with obesity rising from about 68% to 70%. Exercise rates remained high **(82–87%)**, while binge drinking stayed steady around **36–38%**, suggesting limited behavioral change despite increasing obesity levels.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
bmi_sex <- brfss %>%
  count(sex, bmi_category) %>%
  group_by(sex) %>%
  mutate(prop = n / sum(n)) %>%
  select(sex, bmi_category, prop)
kable(bmi_sex, caption = '<span style="font-weight: bold;color: forestgreen;">BMI category by sex</span>')
```
<br>
Data suggests that Males are more likely to be overweight or obese than females, while females have higher proportions in the normal and underweight categories. This indicates a clear sex difference in BMI distribution, with males tending toward higher BMI.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
overweight_year <- brfss %>%
  group_by(interview_year, overweight_or_obese) %>%
  summarize(n = n(), .groups = "drop") %>%
  group_by(interview_year) %>%
  mutate(prop = n / sum(n)) %>%
  select(interview_year, overweight_or_obese, prop)
kable(overweight_year, caption = '<span style="font-weight: bold;color: thistle;">Obesity proportion by year</span>',align = c("l", "l", "l"))
```
<br>
The proportion of adults classified as overweight or obese has slightly increased from 2018 (68%) to 2023 (about 69.5%), while the proportion of non-overweight adults has slightly decreased. Overall, obesity prevalence has remained relatively stable but shows a gradual upward trend over the years.
<br>
<br>

# EDA
```{r, message=FALSE, warning=FALSE}
obesity_exercise <- brfss %>%
  group_by(interview_year, any_exercise_last_month) %>%
  summarise(obesity_prev = mean(overweight_or_obese == "Yes", na.rm = TRUE), .groups = "drop")

p_ex_ob <- ggplot(obesity_exercise, aes(x = factor(interview_year), y = obesity_prev, fill = any_exercise_last_month)) +
  geom_bar(stat="identity", position="dodge") +
  scale_y_continuous(labels = percent_format(accuracy=1)) +
  labs(title = "Obesity Prevalence by Exercise Status (2018–2023)", x = "Year", y = "Obesity %", fill = "Exercise") +
  theme_minimal(base_size=14)

p_ex_ob
```
<br>
The chart indicates that in every year from 2018 to 2023, the obesity prevalence among adults who reported no physical activity was consistently and significantly higher by about 10 percentage points than among those who did exercise.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
age_dist <- ggplot(brfss, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "#56B4E9", color = "white") +
  labs(title = "Age Distribution of Respondents", x = "Age", y = "Count") +
  theme_minimal()
age_dist
```
<br>
The distribution shows that respondents are heavily concentrated in the younger age groups, with the highest counts falling between the late teens and early forties. The count of respondents decreases steadily and significantly after age 45, indicating the survey sample is top-heavy with younger adults. 
<br>
<br>

```{r, message=FALSE, warning=FALSE}
bmi_year <- ggplot(brfss, aes(x = factor(interview_year), y = bmi)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "BMI Distribution by Year", x = "Year", y = "BMI") +
  theme_minimal()
bmi_year
```
<br>
This box plot demonstrates that the median BMI and the overall distribution of BMI scores remained highly consistent and stable across all survey years from 2018 through 2023. While the obesity prevalence charts showed an upward trend, this plot suggests that the center of the BMI distribution did not shift dramatically over the period.
<br>
<br>

# Data Considerations

## Dataset Limitations
The BRFSS data are self-reported, which may introduce bias in height, weight, and behavioral measures such as exercise and alcohol use.

As a cross-sectional survey, the data capture snapshots each year, so causal relationships or longitudinal trends at the individual level cannot be determined.

Certain sub-populations may be underrepresented, including those without phone access or institutionalized adults, which could affect generalizability.

Some variables have missing or implausible values that require filtering, potentially reducing sample size and statistical power.

## Analysis Rationale
Descriptive statistics were used to summarize key variables and provide an overall understanding of patterns in the dataset. Statistical tests, including ANOVA and chi-square, were applied to evaluate differences between groups and associations between categorical variables. These methods allow for examining both mean differences and distributional relationships, offering a comprehensive view of the relationships in the data while remaining flexible across different research questions.

## Refined Research Question
Initially, the research question focused broadly on changes in health outcomes over time. After exploratory data analysis, it became clear that patterns within the dataset could inform more specific questions about factors associated with these outcomes. The refined question now emphasizes understanding how key variables relate to the outcomes of interest and whether these relationships vary across time or groups, allowing for a more targeted and data-driven investigation.

# Question#1


## Description
This analysis estimates the weighted prevalence of overweight or obesity among U.S. adults (2018–2023) using data from the Behavioral Risk Factor Surveillance System (BRFSS). The study uses a complex survey design to account for weights, strata, and PSUs, providing nationally representative results on obesity trends across six survey years.
<br>

## Summary statistics
**Steps:** Load libraries → Read data → Define survey design → Compute weighted prevalence
```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(survey)
library(ggplot2)

brfss_all <- readRDS("C:/Users/namitha/Downloads/brfss_2018_2023.rds")

glimpse(brfss_all)
table(brfss_all$interview_year)

options(survey.lonely.psu = "adjust")
brfss_design <- svydesign(
id = ~psu,
strata = ~strata,
weights = ~weight_final,
data = brfss_all,
nest = TRUE
)

prev_trends <- svyby(
~overweight_or_obese,
~interview_year,
brfss_design,
svymean,
na.rm = TRUE
)

prev_df <- as.data.frame(prev_trends) %>%
select(interview_year, overweight_or_obeseYes, se.overweight_or_obeseYes) %>%
rename(prevalence = overweight_or_obeseYes, se = se.overweight_or_obeseYes)

knitr::kable(prev_df, caption = 'Weighted Prevalence of Overweight/Obesity by Year (2018–2023)')
```
Across survey years 2018–2023, the weighted analysis shows a steady increase in obesity prevalence among U.S. adults. This upward trend suggests a continuing public health challenge related to overweight and obesity, consistent with national surveillance patterns reported by BRFSS.
<br>
<br>
<br>


## Visualizations
```{r, message=FALSE, warning=FALSE}
if(!dir.exists("outputs")) dir.create("outputs")

prev_plot <- ggplot(prev_df, aes(x = interview_year, y = prevalence)) +
geom_line(size = 1.2, color = "red") +
geom_point(size = 3, color = "red") +
labs(
title = "Prevalence of Overweight or Obesity (2018–2023)",
y = "Weighted Prevalence",
x = "Year"
) +
theme_minimal(base_size = 14)
prev_plot

ggsave("outputs/overweight_trend.png", plot = prev_plot, width = 7, height = 5)
```
<br> The line chart shows a **gradual increase in the prevalence of overweight or obesity from 2018 to 2023**. The trend highlights that a growing proportion of U.S. adults fall into overweight or obese categories each year, reflecting persistent population-level risk factors related to diet, physical activity, and lifestyle. <br> <br> <br>

## Conclusion
The BRFSS-based survey-weighted analysis indicates that obesity prevalence among U.S. adults has steadily increased over the 2018–2023 period.
Given the consistent rise, these findings emphasize the ongoing need for targeted public health interventions promoting physical activity, healthy diet, and weight management at the community level.
<br>
<br>

## Associated scripts: `scripts/q1.R`


# Question#2

## Description
This analysis explores the relationship between lifestyle behaviors (exercise and binge drinking) and obesity prevalence among adults using BRFSS data (2018–2023). The goal is to examine trends over time, differences by behavior, and statistical significance.
<br>

## Visualizations
```{r, message=FALSE, warning=FALSE}
summary_exercise <- brfss %>%
  group_by(any_exercise_last_month) %>%
  summarise(
    n = n(),
    mean_bmi = mean(bmi, na.rm = TRUE),
    sd_bmi = sd(bmi, na.rm = TRUE),
    .groups = "drop"
  )

summary_exercise_labels <- summary_exercise %>%
  mutate(label = paste0("n=", n, "\nmean=", round(mean_bmi, 2), "\nsd=", round(sd_bmi, 2)))

p_bmi_ex <- ggplot(brfss, aes(x = any_exercise_last_month, y = bmi, fill = any_exercise_last_month)) +
  geom_boxplot(outlier.size = 0.5, color = "black", alpha = 0.8) +
  labs(
    title = "BMI Distribution by Exercise Status",
    x = "Any Exercise Last Month",
    y = "BMI",
    fill = "Exercise"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", hjust = 0.5)
  ) +
  scale_fill_brewer(palette = "Set2")

p_bmi_ex <- p_bmi_ex +
  geom_text(
    data = summary_exercise_labels,
    aes(
      x = any_exercise_last_month,
      y = max(brfss$bmi, na.rm = TRUE) + 1.5,
      label = label
    ),
    size = 3.0,
    hjust = 1.2,
    vjust = 2.0
  )

p_bmi_ex
```
<br>
The box plot shows that, on average, individuals who **do not** exercise have a visibly higher median **BMI** and a broader distribution compared to those who do exercise.
<br>
<br>
<br>

```{r, message=FALSE, warning=FALSE}
heat_exercise <- brfss %>%
  group_by(interview_year, any_exercise_last_month) %>%
  summarise(obesity_prev = mean(overweight_or_obese == "Yes"), .groups="drop")

p_heat_ex <- ggplot(heat_exercise, aes(x=factor(interview_year), y=any_exercise_last_month, fill=obesity_prev)) +
  geom_tile(color="white") + scale_fill_gradient(low="white", high="red", labels=percent_format(accuracy=1)) +
  labs(title="Obesity Heatmap: Year × Exercise", x="Year", y="Exercise", fill="Obesity %") +
  theme_minimal(base_size=14)

p_heat_ex
```
<br>
The heatmap distinctly shows a bimodal distribution of obesity, with the **"No Exercise"** group consistently remaining in the highest obesity bracket *(>75%, dark red)*, while the **"Yes Exercise"** group remains firmly in the lowest bracket *(<70%, light pink)* across all years. 
<br>
<br>
<br>

```{r, message=FALSE, warning=FALSE}
obesity_exercise <- brfss %>%
  group_by(interview_year, any_exercise_last_month) %>%
  summarise(obesity_prev = mean(overweight_or_obese == "Yes", na.rm = TRUE), .groups = "drop")

p_ex_tr <- ggplot(obesity_exercise, aes(x = interview_year, y = obesity_prev,
                                        color = any_exercise_last_month, group = any_exercise_last_month)) +
  geom_line(size = 1.1) +
  geom_point(size = 2.5) +
  scale_y_continuous(labels = percent_format(accuracy = 1)) +
  labs(title = "Obesity Trend by Exercise Status (2018–2023)",
       x = "Year", y = "Obesity Prevalence", color = "Exercise") +
  theme_minimal(base_size = 14)
p_ex_tr
```
<br>
The prevalence of obesity significantly increased for both groups between 2018 and 2023, while the **non-exercising** population consistently maintained an obesity rate 8–10 percentage points higher than those who were active. 
<br>
<br>

## Statistical tests
```{r, message=FALSE, warning=FALSE, echo=FALSE}
# Function to create a small stratified sample by year
create_small_brfss <- function(data, year_col = "interview_year", n_per_year = 2000, seed = 2025) {
  set.seed(seed)  # for reproducibility
  data %>%
    group_by(.data[[year_col]]) %>%
    slice_sample(n = n_per_year) %>%
    ungroup()
}

brfss <- create_small_brfss(readRDS('../data/processed/brfss_2018_2023.rds'), year_col = "interview_year", n_per_year = 2000)
brfss$interview_year <- factor(brfss$interview_year)
```

```{r, message=FALSE, warning=FALSE}
options(survey.lonely.psu = "adjust")
brfss_design <- svydesign(
  ids = ~psu,     
  strata = ~strata,
  weights = ~weight_final,
  data = brfss,
  nest = TRUE
)
```

### ANOVA
```{r, message=FALSE, warning=FALSE, echo=FALSE}
survey_anova_table <- function(svy_model, factor_name) {
  library(survey)
  
  f_test <- regTermTest(svy_model, as.formula(paste0("~", factor_name)))
  
  Df_num <- f_test$df[1]
  F_val  <- f_test$Ftest
  P_val  <- f_test$p
  
  data.frame(
    Term = factor_name,
    Df_num = Df_num,
    F_value = F_val,
    Pr_F = P_val
  )
}

survey_tukey_table_fixed <- function(svy_model, factor_name, conf_level = 0.95, digits = NULL) {
  coefs <- coef(svy_model)
  vc <- vcov(svy_model)
  coef_names <- names(coefs)
  
  mf <- model.frame(svy_model)
  if (!factor_name %in% names(mf)) stop("factor_name not found in model frame")
  levels_factor <- levels(mf[[factor_name]])
  if (is.null(levels_factor) || length(levels_factor) < 2) stop("factor must have >= 2 levels")
  
  alpha <- 1 - conf_level
  zval <- qnorm(1 - alpha/2)
  
  mean_vector_for_level <- function(level) {
    vec <- rep(0, length(coefs))
    names(vec) <- coef_names
    if ("(Intercept)" %in% coef_names) vec["(Intercept)"] <- 1
    ref_level <- levels_factor[1]
    if (level == ref_level) return(vec)
    target_name <- paste0(factor_name, level)
    if (!target_name %in% coef_names) {
      matches <- grep(paste0(factor_name, ".*", level, "$"), coef_names, value = TRUE)
      if (length(matches) == 0) stop("Cannot find coefficient name for level: ", level)
      target_name <- matches[1]
    }
    vec[target_name] <- 1
    return(vec)
  }
  
  pairs <- combn(levels_factor, 2, simplify = FALSE)
  rows <- lapply(pairs, function(pr) {
    l1 <- pr[1]; l2 <- pr[2]
    v1 <- mean_vector_for_level(l1)
    v2 <- mean_vector_for_level(l2)
    contrast <- v2 - v1                 # mean(level2) - mean(level1)
    diff <- as.numeric(sum(coefs * contrast))
    var_diff <- as.numeric(t(contrast) %*% vc %*% contrast)
    se <- sqrt(var_diff)
    lwr <- diff - zval * se
    upr <- diff + zval * se
    pval <- 2 * (1 - pnorm(abs(diff / se)))
    tib <- data.frame(
      Comparison = paste0(l2, " - ", l1),
      diff = diff,
      lwr = lwr,
      upr = upr,
      p_value = pval,
      stringsAsFactors = FALSE
    )
    return(tib)
  })
  
  out <- bind_rows(rows)
  if (!is.null(digits) && is.numeric(digits)) {
    numcols <- setdiff(names(out), "Comparison")
    out[numcols] <- lapply(out[numcols], function(x) round(x, digits))
  }
  rownames(out) <- NULL
  return(out)
}
```

```{r, message=FALSE, warning=FALSE}
anova_exercise <- svyglm(bmi ~ any_exercise_last_month, design = brfss_design)
anova_table <- survey_anova_table(anova_exercise, "any_exercise_last_month")
kable(anova_table, caption = '<span style="font-weight: bold;color: green;">Anova Test: BMI vs Exercise</span>')
```

```{r, message=FALSE, warning=FALSE}
tukey_fixed <- survey_tukey_table_fixed(anova_exercise, "any_exercise_last_month", conf_level = 0.95, digits = 3)
kable(tukey_fixed, caption = '<span style="font-weight: bold;color: green;">Tukey Test: BMI vs Exercise</span>')
```
<br>
The ANOVA showed a significant effect of exercise on BMI (*F* = 35.84, *p* < 0.001). Tukey’s test indicated that individuals who did not exercise in the last month had a significantly higher BMI (mean difference = 1.85, 95% CI [1.24, 2.45], *p* < 0.001) than those who exercised.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
anova_binge <- svyglm(bmi ~ binge_drinking, design = brfss_design)
anova_table <- survey_anova_table(anova_binge, "binge_drinking")
kable(anova_table, caption = '<span style="font-weight: bold;color: goldenrod;">Anova Test: BMI vs Binge drinking</span>')
```

```{r, message=FALSE, warning=FALSE}
tukey_fixed <- survey_tukey_table_fixed(anova_binge, "binge_drinking", conf_level = 0.95, digits = 3)
kable(tukey_fixed, caption = '<span style="font-weight: bold;color: goldenrod;">Tukey Test: BMI vs Binge drinking</span>')
```
<br>
The ANOVA revealed a significant effect of binge drinking on BMI (*F* = 6.83, *p* = 0.009). Tukey’s test showed that individuals who reported binge drinking had a higher BMI on average (mean difference = 0.56, 95% CI [0.14, 0.97], *p* = 0.009) compared to those who did not.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
anova_year <- svyglm(bmi ~ interview_year, design = brfss_design)
anova_table <- survey_anova_table(anova_year, "interview_year")
kable(anova_table, caption = '<span style="font-weight: bold;color: red;">Anova Test: BMI vs Interview Year</span>')
```
<br>
The ANOVA showed no significant effect of interview year on BMI (*F* = 1.70, *p* = 0.13), indicating that average BMI did not differ significantly across survey years.
<br>
<br>

### Chi Square
```{r, message=FALSE, warning=FALSE, echo=FALSE}
svy_chi_test <- function(var1, var2, design) {
  fml <- as.formula(paste0("~", var1, " + ", var2))
  chisq_svy <- svychisq(fml, design = design, statistic = "Chisq")
  chi_summary <- data.frame(
    Statistic = chisq_svy$statistic,
    DF = chisq_svy$parameter,
    P_Value = chisq_svy$p.value
  )
  chi_summary
}
```

```{r, message=FALSE, warning=FALSE}
result <- svy_chi_test("bmi_category", "any_exercise_last_month", brfss_design)
kable(result, caption = '<span style="font-weight: bold;color: purple;">Chi-square Test: BMI vs Exercise</span>')
```
<br>
The chi-square test showed a significant association between BMI category and exercise status ($\chi$ = 155.65, *p* < 0.001), indicating that BMI distribution differs by exercise behavior.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
result <- svy_chi_test("binge_drinking", "interview_year", brfss_design)
kable(result, caption = '<span style="font-weight: bold;color: orange;">Chi-square Test: Binge Drinking vs Interview Year</span>')
```
<br>
The chi-square test showed **no significant association** between binge drinking and interview year ($\chi$ = 9.80, *p* = 0.74), indicating that the prevalence of binge drinking did not differ significantly across survey years.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
result <- svy_chi_test("bmi_category", "binge_drinking", brfss_design)
kable(result, caption = '<span style="font-weight: bold;color: brown;">Chi-square Test: BMI vs Binge Drinking</span>')
```
<br>
The chi-square test indicated a **significant association** between BMI category and binge drinking ($\chi$ = 31.31, *p* = 0.025), suggesting that BMI distribution differs depending on binge drinking status.
<br>
<br>

```{r, message=FALSE, warning=FALSE}
result <- svy_chi_test("overweight_or_obese", "interview_year", brfss_design)
kable(result, caption = '<span style="font-weight: bold;color: slateblue;">Chi-square Test: BMI vs Binge Drinking</span>')
```
<br>
The chi-square test showed **no significant association** between BMI category and binge drinking across survey years ($\chi$ = 16.15, *p* = 0.51), indicating that BMI distribution does not differ significantly by binge drinking status in this context.
<br>
<br>

## Conclusion

### Exercise and BMI

Non-exercisers had higher BMI and a wider BMI distribution compared to those who exercised. ANOVA confirmed a significant difference (F = 35.84, p < 0.001), and Tukey’s test showed a mean difference of 1.85 units. The chi-square test also indicated higher obesity prevalence among non-exercisers ($\chi$ = 155.65, p < 0.001).

### Binge Drinking and BMI

Binge drinkers had slightly higher BMI than non-binge drinkers, with a mean difference of 0.56 (F = 6.83, p = 0.009). Chi-square analysis supported this association ($\chi$ = 31.31, p = 0.025). However, prevalence of binge drinking did not change significantly across years.

### Trends Across Years

BMI did not vary significantly across survey years (F = 1.70, p = 0.13), suggesting stable obesity levels from 2018–2023. Visualizations showed slight increases in obesity for both exercise groups, with non-exercisers consistently higher. Binge drinking prevalence remained largely unchanged over time.

### Summary

This data suggests that lifestyle behaviors, particularly exercise, are key determinants of BMI and obesity. Non-exercisers consistently had higher BMI, while binge drinking had a smaller effect. Year-to-year changes were minimal, highlighting the importance of promoting physical activity to reduce obesity risk.

# Question#3

## Description
This analysis explores the association between demographic groups and obesity among U.S. adults in the post-COVID period (2021–2023) using BRFSS data. The analysis tests if there are yearly changes in body mass index (BMI) by gender and ethnicity. In addition, associations between pre-Covid and post-Covid body mass index (BMI) are examined by demographic group. 
<br>

# Question#3

## Description
This analysis explores the association between demographic groups and obesity among U.S. adults in the post-COVID period (2021–2023) using BRFSS data. The analysis tests if there are yearly changes in body mass index (BMI) by gender and ethnicity. In addition, associations between pre-Covid and post-Covid body mass index (BMI) are examined by demographic group. 
<br>

```{r reload_data, message=FALSE, warning=FALSE, echo=FALSE}
setwd("C:/Users/dhowell07/Documents/DATS6101/R/Project1")

brfss = read.csv("brfss_2018_2023.csv", header=T)
```

```{r demo_data, message=FALSE, warning=FALSE, echo=FALSE}
##Make a data set that includes only demographic data and change categorical data from character to factor class. Also, add order to interview year, BMI category, age group, and education level
brfss_demo = brfss[,c(1:6,7,12,14:18)]
brfss_demo$psu = as.factor(brfss_demo$psu)
brfss_demo$psu <- factor(brfss_demo$psu)
brfss_demo$interview_year = as.factor(brfss_demo$interview_year)
brfss_demo$interview_year <- factor(brfss_demo$interview_year, order=T,levels = c("2018","2019","2020","2021","2022","2023"))
brfss_demo$bmi_category = as.factor(brfss_demo$bmi_category)
brfss_demo$bmi_category <- factor(brfss_demo$bmi_category, order=T,levels = c("Underweight","Normal weight","Overweight","Obese"))
brfss_demo$overweight_or_obese = as.factor(brfss_demo$overweight_or_obese)
brfss_demo$overweight_or_obese <- factor(brfss_demo$overweight_or_obese, order=T,levels = c("Yes","No"))
brfss_demo$sex = as.factor(brfss_demo$sex)
brfss_demo$sex <- factor(brfss_demo$sex, order=F)
brfss_demo$age_group = as.factor(brfss_demo$age_group)
brfss_demo$age_group <- factor(brfss_demo$age_group, order=T,levels = c("18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74","75-79","80 or older"))
brfss_demo$race_ethnicity = as.factor(brfss_demo$race_ethnicity)
brfss_demo$race_ethnicity <- factor(brfss_demo$race_ethnicity, order=F)
brfss_demo$education_level = as.factor(brfss_demo$education_level)
brfss_demo$education_level <- factor(brfss_demo$education_level, order=T,levels = c("No school/K","Grades 1-8","Grades 9-11","Grade 12/GED","College 1-3 years","College 4+ years"))
```

## Summary Statistics: ANOVA
ANOVA was used to tests if there was a difference in the yearly body mass index (BMI) by gender and ethnicity. This will give insight on if based on gender and ethnicity there are changes in obesity from 2018 -2023. 
<br>
<br>
<u>BMI by Gender</u>
Male:
```{r male_data, message=FALSE, warning=FALSE, echo=FALSE}
##Male##
male = subset(brfss_demo,sex %in% 'Male')
```
First, an outlier check is done to observe if the male dataset meets the ANOVA assumptions (normality, homogeneity of variances, and independence).

```{r maleclean_data, message=FALSE, warning=FALSE}
maleclean = outlierKD2(male, bmi, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
```
The results show that the male dataset does not meet the assumption of normality. A dataset without outliers is used, resulting in about 3% of males being removed. The Levene's test for homegeneity of variance was done on the male dataset with the outliers removed and it the assumption was met. 

```{r malecleanlevene_data, message=FALSE, warning=FALSE}
leveneTest(bmi~interview_year,maleclean)
```
The same test were done for the female dataset and datasets for each ethnicity group. It was found that with outliers removed, the ANOVA assumptions were met. 
<br>
<br>
An ANOVA test can be run to test if the mean BMI is the same for males for each year.
```{r malecleananova_data, message=FALSE, warning=FALSE}
maleclean_anova = aov(bmi ~ interview_year, data=maleclean)
xkabledply(maleclean_anova)
summary(maleclean_anova)
```
The p-value is 0.0066, the null hypothesis that the mean BMI are to same for males is rejected. 
<br>
<br>
Next, the Tukey-Kramer test is done to identify years where the mean BMI difference is found
```{r malecleantukey_data, message=FALSE, warning=FALSE}
tukeymaleclean<- TukeyHSD(maleclean_anova) 
tukeymaleclean
```
From the Tukey-Kramer test, it is observed that the p-values are less than 0.05 when comparing years 2021 & 2019 and years 2022 & 2019. 
<br>
<br>
Female:
```{r femaleclean_data, message=FALSE, warning=FALSE, echo=FALSE, results='hide',fig.show='hide'}
female = subset(brfss_demo,sex %in% 'Female')
femaleclean = outlierKD2(female, bmi, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
leveneTest(bmi~interview_year,femaleclean)
```
An ANOVA test can be run to test if the mean BMI is the same for females for each year.
```{r femalecleananova_data, message=FALSE, warning=FALSE}
femaleclean_anova = aov(bmi ~ interview_year, data=femaleclean)
xkabledply(femaleclean_anova)
summary(femaleclean_anova)
```
The p-value is 3.51e -08, the null hypothesis that the mean BMI are to same for females is rejected. 
<br>
<br>
Next, the Tukey-Kramer test is done to identify years where the mean BMI difference is found for females.
```{r femalecleantukey_data, message=FALSE, warning=FALSE}
tukeyfemaleclean<- TukeyHSD(femaleclean_anova) 
tukeyfemaleclean
```
From the Tukey-Kramer test, it is observed that the p-values are less than 0.05 when comparing years 2021 & 2019 and years 2022 & 2019 for females.
<br>
<br>
<u>BMI by Ethnicity</u>
<br>
<br>
White:
```{r whiteclean_data, message=FALSE, warning=FALSE, echo=FALSE, results='hide',fig.show='hide'}
white = subset(brfss_demo,race_ethnicity %in% 'White NH')
summary(white)
whiteclean = outlierKD2(white, bmi, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
leveneTest(bmi~interview_year,whiteclean)
```
An ANOVA test can be run to test if the mean BMI is the same for people of white ethnicity for each year.
```{r whitecleananova_data, message=FALSE, warning=FALSE}
whiteclean_anova = aov(bmi ~ interview_year, data=whiteclean)
xkabledply(whiteclean_anova)
summary(whiteclean_anova)
```
The p-value is 1.71e -09, the null hypothesis that the mean BMI are to same for whites is rejected. 
<br>
<br>
Next, the Tukey-Kramer test is done to identify years where the mean BMI difference is found for whites
```{r whitecleantukey_data, message=FALSE, warning=FALSE}
tukeywhiteclean<- TukeyHSD(whiteclean_anova) 
tukeywhiteclean
```
From the Tukey-Kramer test, it is observed that the p-values are less than 0.05 when comparing years 2018 & 2022, 2019 & 2021, 2019 & 2022, and 2019 & 2023.
<br>
<br>
Hispanic:
```{r hispanicclean_data, message=FALSE, warning=FALSE, echo=FALSE, results='hide',fig.show='hide'}
hispanic = subset(brfss_demo,race_ethnicity %in% 'Hispanic')
summary(hispanic)
hispanicclean = outlierKD2(hispanic, bmi, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
leveneTest(bmi~interview_year,hispanicclean)
```
An ANOVA test can be run to test if the mean BMI is the same for people of hispanic ethnicity for each year.
```{r hispaniccleananova_data, message=FALSE, warning=FALSE}
hispanicclean_anova = aov(bmi ~ interview_year, data=hispanicclean)
xkabledply(hispanicclean_anova)
summary(hispanicclean_anova)
```
The p-value is 0.72, the null hypothesis that the mean BMI are to same for hispanics fails to be rejected.Based on the p-value from the ANOVA test, a the Tukey-Kramer test does not need to be done to identify any years where there is a mean BMI difference found for hispanics. 
<br>
<br>

```
From the Tukey-Kramer test, it is observed that the no p-values are less than 0.05.
<br>
<br>
Black:
```{r blackclean_data, message=FALSE, warning=FALSE, echo=FALSE, results='hide',fig.show='hide'}
black = subset(brfss_demo,race_ethnicity %in% 'Black NH')
summary(black)
blackclean = outlierKD2(black, bmi, rm = TRUE, boxplt = TRUE, qqplt = TRUE)
leveneTest(bmi~interview_year,blackclean)
```
An ANOVA test can be run to test if the mean BMI is the same for people of black ethnicity for each year.
```{r blackcleananova_data, message=FALSE, warning=FALSE}
blackclean_anova = aov(bmi ~ interview_year, data=blackclean)
xkabledply(blackclean_anova)
summary(blackclean_anova)
```
The p-value is 0.73, the null hypothesis that the mean BMI are to same for blacks fails to be rejected. Based on the p-value from the ANOVA test, a the Tukey-Kramer test does not need to be done to identify any years where there is a mean BMI difference found for blacks.

## Visualizations: ANOVA
<br>
The following bollowing boxplots for male, female, and white ethnicity show that the median BMI is pretty consistent for each year for each gender and ethinicity. It can also be observed that there are more outliers for higher BMIs compared to lower BMIs. The same trend is observed in people of hispanic and black ethnicities. 

```{r malecleanboxplot_data, message=FALSE, warning=FALSE}
ggplot(maleclean, aes(x=interview_year, y=bmi,fill = interview_year)) + 
  geom_boxplot(outlier.size=2, color ="black") +
  labs(x="Year", y = "Body Mass Index (BMI)")+
  ggtitle("Body Mass Index (BMI) for Males from 2018 - 2023")+
  theme(legend.position ="none",plot.title = element_text(face = "bold",hjust=0.5))+
  scale_fill_brewer(palette ="Set2")
```
```{r femalecleanboxplot_data, message=FALSE, warning=FALSE}
ggplot(femaleclean, aes(x=interview_year, y=bmi,fill = interview_year)) + 
  geom_boxplot(outlier.size=2, color ="black") +
  labs(x="Year", y = "Body Mass Index (BMI)")+
  ggtitle("Body Mass Index (BMI) for Females from 2018 - 2023")+
  theme(legend.position ="none",plot.title = element_text(face = "bold",hjust=0.5))+
  scale_fill_brewer(palette ="Set2")
```
```{r whitecleanboxplot_data, message=FALSE, warning=FALSE}
library("ggplot2")
ggplot(whiteclean, aes(x=interview_year, y=bmi,fill = interview_year)) + 
  geom_boxplot(outlier.size=2, color ="black") +
  labs(x="Year", y = "Body Mass Index (BMI)")+
  ggtitle("Body Mass Index (BMI) for White Ethnicity from 2018 - 2023")+
  theme(legend.position ="none",plot.title = element_text(face = "bold",hjust=0.5))+
  scale_fill_brewer(palette ="Set2")
```
```{r hispaniccleanboxplot_data, message=FALSE, warning=FALSE,fig.show='hide'}
library("ggplot2")
ggplot(hispanicclean, aes(x=interview_year, y=bmi,fill = interview_year)) + 
  geom_boxplot(outlier.size=2, color ="black") +
  labs(x="Year", y = "Body Mass Index (BMI)")+
  ggtitle("Body Mass Index (BMI) for Hispanic Ethnicity from 2018 - 2023")+
  theme(legend.position ="none",plot.title = element_text(face = "bold",hjust=0.5))+
  scale_fill_brewer(palette ="Set2")
```
```{r blackcleanboxplot_data, message=FALSE, warning=FALSE,fig.show='hide'}
ggplot(blackclean, aes(x=interview_year, y=bmi,fill = interview_year)) + 
  geom_boxplot(outlier.size=2, color ="black") +
  labs(x="Year", y = "Body Mass Index (BMI)")+
  ggtitle("Body Mass Index (BMI) for Black Ethnicity from 2018 - 2023")+
  theme(legend.position ="none",plot.title = element_text(face = "bold",hjust=0.5))+
  scale_fill_brewer(palette ="Set2")
```
## Conclusion

### Gender and BMI
Based on gender there was a significant difference found between BMI rates for males and females. The ANOVA test confirmed a significant difference with both tests for males and females resulting in a p-value less than 0.05. The Tukey-Kramer test showed that the mean difference may be between years 2019 and 2021 & 2022. This shows that there is a mean BMI difference between the years before Covid and the years following Covid for males and females.

### Ethnicity and BMI

Based on ethnicity there was a significant difference found between BMI rates for people of white ethnicity.The ANOVA test confirmed a significant difference resulting in a p-value less than 0.05. The Tukey-Kramer test showed that the mean difference may be between years 2018 & 2022, 2019 & 2021, 2019 & 2022, and 2019 & 2023. This shows that there is a mean BMI difference between the years before Covid and the years following Covid for people of white ethnicity. For Hispanics and Blacks, the ANOVA test did not show that there was a difference in BMI rates. This may be due to both ethinicity representing a smaller portion of the sampled group.



## Summary statistics

```{r message=FALSE, warning=FALSE}
library(dplyr)
library(survey)
library(ggplot2)
library(tidyr)
library(scales)

brfss_data <- readRDS("C:/Users/namitha/Downloads/brfss_2018_2023.rds")

# Filter data for post-COVID years and create indicator variables
brfss_postcovid <- brfss_data %>%
  filter(interview_year >= 2021) %>%
  mutate(
    obese = ifelse(bmi_category == "Obese", 1, 0),
    diabetes = ifelse(diabetes_status %in% c("Yes", "Yes, only pregnancy"), 1, 0),
    cardio = ifelse(heart_attack_history == "Yes" | coronary_hd_history == "Yes", 1, 0),
    stroke = ifelse(stroke_history == "Yes", 1, 0),
    depression = ifelse(depression_history == "Yes", 1, 0)
  )

# Define complex survey design
options(survey.lonely.psu = "adjust")
brfss_design <- svydesign(
  id = ~psu,
  strata = ~strata,
  weights = ~weight_final,
  data = brfss_postcovid,
  nest = TRUE
)

# Weighted prevalence function
weighted_prev <- function(var) {
  svyby(as.formula(paste0("~", var)), ~obese, brfss_design, svymean, na.rm = TRUE)
}

# Calculate weighted prevalence and chi-square tests
diabetes_prev <- weighted_prev("diabetes")
cardio_prev <- weighted_prev("cardio")
stroke_prev <- weighted_prev("stroke")
depression_prev <- weighted_prev("depression")

diabetes_chisq <- svychisq(~diabetes + obese, design = brfss_design)
cardio_chisq <- svychisq(~cardio + obese, design = brfss_design)
stroke_chisq <- svychisq(~stroke + obese, design = brfss_design)
depression_chisq <- svychisq(~depression + obese, design = brfss_design)

# Combine results into one table
chronic_by_obese <- data.frame(
  Condition = c("Diabetes", "Cardiovascular Disease", "Stroke", "Depression"),
  Non_Obese = c(diabetes_prev[1, 2], cardio_prev[1, 2], stroke_prev[1, 2], depression_prev[1, 2]),
  Obese = c(diabetes_prev[2, 2], cardio_prev[2, 2], stroke_prev[2, 2], depression_prev[2, 2]),
  P_Value = c(diabetes_chisq$p.value, cardio_chisq$p.value, stroke_chisq$p.value, depression_chisq$p.value)
)

knitr::kable(chronic_by_obese, caption = 'Weighted Prevalence of Chronic Conditions by Obesity Status (Post-COVID: 2021–2023)')
```
<br> Across post-COVID years (2021–2023), adults with **obesity** show markedly **higher prevalence** of all major chronic conditions compared to non-obese adults. - **Diabetes** and **cardiovascular disease** display the largest differences, with obese individuals reporting more than double the prevalence rates. - **Chi-square tests** indicate statistically significant associations (*p* < 0.001) for all conditions, confirming that obesity is a strong risk factor for chronic morbidity. <br><br><br>

## Visualizations
```{r message=FALSE, warning=FALSE}
chronic_long <- chronic_by_obese %>%
pivot_longer(cols = c("Non_Obese", "Obese"), names_to = "Obesity_Status", values_to = "Prevalence")

ggplot(chronic_long, aes(x = Condition, y = Prevalence, fill = Obesity_Status)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "Weighted Prevalence of Chronic Conditions by Obesity Status (Post-COVID: 2021–2023)",
x = "Chronic Condition",
y = "Weighted Prevalence (%)",
fill = "Obesity Status"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 20, hjust = 1))

if (!dir.exists("outputs")) dir.create("outputs")
write.csv(chronic_by_obese, "outputs/chronic_by_obese_postcovid.csv", row.names = FALSE)

```
<br> The bar chart shows a clear pattern: **obese adults experience higher prevalence** across all chronic health outcomes. - **Diabetes** and **cardiovascular disease** stand out as the most obesity-linked conditions. - **Depression** also shows elevated prevalence among obese adults, emphasizing the mental–physical health connection in the post-pandemic period. <br><br><br>

## Findings and interpretation

<br> Post-COVID BRFSS data (2021–2023) reveal strong, statistically significant links between obesity and major chronic diseases, including diabetes, cardiovascular disease, stroke, and depression.
These findings highlight obesity as a central determinant of health in the post-pandemic U.S. population and underscore the importance of targeted prevention programs, integrated chronic disease management, and behavioral health support to reduce long-term health burdens.
<br>
<br>

# Question#4

## Description
This analysis explores the association between obesity and chronic health conditions (diabetes, cardiovascular disease, stroke, and depression) among U.S. adults in the post-COVID period (2021–2023) using BRFSS data. The complex survey design accounts for sampling weights, strata, and primary sampling units to ensure nationally representative estimates.
<br>

## Summary statistics
```{r message=FALSE, warning=FALSE}
library(dplyr)
library(survey)
library(ggplot2)
library(tidyr)
library(scales)

brfss_data <- readRDS("C:/Users/namitha/Downloads/brfss_2018_2023.rds")

brfss_postcovid <- brfss_data %>%
  filter(interview_year >= 2021) %>%
  mutate(
    obese = ifelse(bmi_category == "Obese", 1, 0),
    diabetes = ifelse(diabetes_status %in% c("Yes", "Yes, only pregnancy"), 1, 0),
    cardio = ifelse(heart_attack_history == "Yes" | coronary_hd_history == "Yes", 1, 0),
    stroke = ifelse(stroke_history == "Yes", 1, 0),
    depression = ifelse(depression_history == "Yes", 1, 0)
  )

options(survey.lonely.psu = "adjust")
brfss_design <- svydesign(
  id = ~psu,
  strata = ~strata,
  weights = ~weight_final,
  data = brfss_postcovid,
  nest = TRUE
)

weighted_prev <- function(var) {
  svyby(
    as.formula(paste0("~", var)),
    ~obese,
    brfss_design,
    svymean,
    na.rm = TRUE
  )
}

diabetes_prev <- weighted_prev("diabetes")
cardio_prev <- weighted_prev("cardio")
stroke_prev <- weighted_prev("stroke")
depression_prev <- weighted_prev("depression")

diabetes_chisq <- svychisq(~diabetes + obese, design = brfss_design)
cardio_chisq <- svychisq(~cardio + obese, design = brfss_design)
stroke_chisq <- svychisq(~stroke + obese, design = brfss_design)
depression_chisq <- svychisq(~depression + obese, design = brfss_design)

chronic_by_obese <- data.frame(
  Condition = c("Diabetes", "Cardiovascular Disease", "Stroke", "Depression"),
  Non_Obese = c(diabetes_prev[1,2], cardio_prev[1,2], stroke_prev[1,2], depression_prev[1,2]),
  Obese = c(diabetes_prev[2,2], cardio_prev[2,2], stroke_prev[2,2], depression_prev[2,2]),
  P_Value = c(diabetes_chisq$p.value, cardio_chisq$p.value, stroke_chisq$p.value, depression_chisq$p.value)
)

knitr::kable(chronic_by_obese, caption = 'Weighted Prevalence of Chronic Conditions by Obesity Status (Post-COVID: 2021–2023)')
```
<br> Across post-COVID years (2021–2023), adults with obesity show consistently higher weighted prevalence of chronic conditions, particularly diabetes and cardiovascular disease, compared to non-obese adults. All chi-square tests indicate significant associations (p < 0.05) between obesity and chronic illness prevalence.

<br><br><br>

## Visualizations

```{r message=FALSE, warning=FALSE}
chronic_long <- chronic_by_obese %>%
pivot_longer(cols = c("Non_Obese", "Obese"), names_to = "Obesity_Status", values_to = "Prevalence")

ggplot(chronic_long, aes(x = Condition, y = Prevalence, fill = Obesity_Status)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "Weighted Prevalence of Chronic Conditions by Obesity Status (Post-COVID: 2021–2023)",
x = "Chronic Condition",
y = "Weighted Prevalence (%)",
fill = "Obesity Status"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 20, hjust = 1))

if (!dir.exists("outputs")) dir.create("outputs")
write.csv(chronic_by_obese, "outputs/chronic_by_obese_postcovid.csv", row.names = FALSE)
```
<br> The chart shows that obesity is strongly linked with higher prevalence of chronic conditions, especially **diabetes** and **cardiovascular disease**. The contrast between obese and non-obese individuals highlights obesity as a major post-COVID health risk factor.

<br><br><br>

## Conclusion

<br> Post-COVID BRFSS data (2021–2023) reveal that obesity is significantly associated with increased prevalence of chronic diseases such as diabetes, cardiovascular disease, stroke, and depression. The results underline the public health importance of continued obesity prevention and chronic disease management initiatives in the U.S.

<br><br>

Associated scripts: scripts/q4.R

# Discussion

## Cross-cutting insights across Q1–Q4
<br> The analyses from Questions 1 to 4 illustrate the complex and growing public health burden of obesity in the United States.  

From **Q1**, a clear upward trend in the prevalence of overweight and obesity from 2018 to 2023 highlights the steady rise in body weight indicators across the population. This matches national patterns showing that obesity continues to rise after the pandemic.  

In **Q2** and **Q3**, the focus on statistical testing and subgroup comparisons reveals important differences between groups. Factors such as rank, education, or demographic traits significantly influence health outcomes. These findings show that obesity and related behaviors are not evenly spread across all groups.  

Finally, **Q4** connects chronic disease outcomes, showing that people with obesity have much higher rates of diabetes, cardiovascular disease, stroke, and depression in the post-COVID period. The strong links and low p-values in these relationships reinforce the idea that obesity is a major predictor of chronic health issues.  

Taken together, Q1 to Q4 present a clear picture: obesity prevalence has risen steadily, disparities exist across demographic groups, and this condition leads to significant health risks. These insights emphasize the urgent need for combined policy measures that focus on prevention, early screening, and community-based efforts to tackle obesity as a key factor affecting public health in the U.S.
<br><br><br>

## Strengths and limitations

<br>
**Strengths:**

- **Large, nationally representative dataset:** The BRFSS surveys over 400,000 U.S. adults annually, providing strong statistical power and generalizability.  
- **Longitudinal coverage:** Data from 2018–2023 allows assessment of trends before and after the COVID-19 pandemic.  
- **Complex survey design accounted for:** Weighting, stratification, and clustering ensure accurate population-level estimates.  
- **Comprehensive variables:** Includes demographics, lifestyle behaviors, and chronic conditions, enabling multifactorial analyses.  

**Limitations:**

- **Self-reported data:** Height, weight, exercise, and alcohol use may be under- or over-reported, introducing measurement bias.  
- **Cross-sectional design:** Cannot establish causal relationships, only associations.  
- **Potential nonresponse bias:** Certain populations (e.g., institutionalized adults, those without phone access) may be underrepresented.  
- **Missing or implausible values:** Filtering reduces sample size and may slightly affect generalizability.  
<br><br><br>

## Potential additional information

<br>
- Incorporation of dietary intake or more detailed physical activity measures could improve understanding of obesity determinants.  
- Linking to medical records or longitudinal cohorts could help establish causal pathways.  
- Geospatial analysis by state or region may reveal local patterns and policy-relevant insights.  

<br><br><br>

## Conclusion

<br>
**Overall Answers to Research Questions:**

- **Obesity trends (Q1):** Weighted prevalence of overweight and obesity steadily increased from 2018 to 2023, indicating a persistent public health concern.  
- **Lifestyle behaviors (Q2):** Exercise significantly reduces BMI and obesity risk, whereas binge drinking has a smaller but measurable effect.  
- **Demographic disparities (Q3):** Obesity and BMI patterns differ by sex, age, and race/ethnicity, showing population-level disparities.  
- **Chronic conditions (Q4):** Obesity is strongly associated with higher prevalence of diabetes, cardiovascular disease, stroke, and depression in the post-COVID period.  

**Future Work:**

- Explore causal relationships using longitudinal or intervention data.  
- Investigate interactions between diet, exercise, and socioeconomic factors in predicting obesity.  
- Assess the impact of COVID-19 on lifestyle behaviors more closely with finer temporal resolution.  
- Develop predictive models for high-risk populations to inform targeted interventions.  

---
<br><br><br>

## References

<br>
- Centers for Disease Control and Prevention. (2023). *BRFSS overview.* https://www.cdc.gov/brfss/annual_data/2023/pdf/Overview_2023-508.pdf  
- Centers for Disease Control and Prevention. (2021). *Behavioral Risk Factor Surveillance System comparability of data BRFSS 2020.* https://www.cdc.gov/brfss/annual_data/2020/pdf/compare-2020-508.pdf
<br><br><br>


